import{m as w,u as x,_ as v,r as k,o as s,c as n,d as c,b as l,w as g,f as h,F as p,g as d,s as B,t as m,y as D}from"./index-Dy94I-Pl.js";import{_}from"./PaginationComponent-D4S4CCSh.js";import{C as f}from"./CategoriesBar-BeNApewi.js";import{_ as I}from"./no-img-Dap1pkA8.js";const F={components:{CategoriesBar:f,PaginationComponent:_},data(){return{loading:!0,items:[],currentPage:1,pageSize:10,totalPages:1,totalItems:0}},computed:{...w(x,["currentLang"]),filterParams(){const e={};return this.currentPage&&(e.offset=(this.currentPage-1)*this.pageSize),this.pageSize&&(e.limit=this.pageSize),e.categoryId=2,e.sort="created",e.lang=this.currentLang,e}},watch:{filterParams(){this.fetchItems(),this.fetchCount()}},methods:{init(){this.loading=!0;const e=Number(this.$route.query.page)||1;this.currentPage=e;const t=[];t.push(this.fetchItems(),this.fetchCount()),Promise.all(t).finally(()=>{this.loading=!1})},fetchCount(){return this.$axiosApi.get("gazprom-app/content/news/count",{params:this.filterParams}).then(e=>{const{total:t,pages:r}=e.data;this.totalItems=t,this.totalPages=r}).catch(e=>{console.log(e)}).finally(()=>{this.loading=!1})},fetchItems(){return this.loading=!0,this.$axiosApi.get("gazprom-app/content/news",{params:this.filterParams}).then(e=>{this.items=e.data}).catch(e=>{console.log(e)}).finally(()=>{this.loading=!1})},sortNewsByDate(){this.items.sort((e,t)=>new Date(t.created).getTime()-new Date(e.created).getTime())},findCover(e){if(!e)return;const t=e.find(r=>r.tag==="COVER");return t||null},formatDate(e){const t=new Date(e),r=String(t.getDate()).padStart(2,"0"),u=String(t.getMonth()+1).padStart(2,"0"),o=t.getFullYear();return`${r}.${u}.${o}`},onPageChanged(e){this.currentPage=e,this.$router.push({path:this.$route.path,query:{...this.$route.query,page:String(e)}})},onPageSizeChanged(e){this.pageSize=e,this.currentPage=1}},created(){this.init()}},N={class:"container"},E={style:{width:"100%"}},$={key:0,class:"all-news"},b={class:"article-image"},q=["src","alt"],T={key:1,class:"article-image-inner",src:I},V={class:"news-date"},A={key:1,style:{display:"flex","flex-direction":"column",gap:"20px"}};function L(e,t,r,u,o,i){const P=f,y=B,C=k("router-link"),S=_,z=D;return s(),n("div",N,[c(P),l("div",E,[c(y,{tag:"h2",size:"small",style:{margin:"33px 0 30px 0"}},{default:g(()=>[h("Новости для потребителей")]),_:1}),o.loading?(s(),n("div",A,[(s(),n(p,null,d(6,a=>c(z,{key:a,style:{height:"200px",width:"100%","border-radius":"32px","margin-bottom":"30px"}})),64))])):(s(),n("div",$,[(s(!0),n(p,null,d(o.items,a=>(s(),n("div",{key:a.id,class:"article"},[l("div",b,[i.findCover(a.images)?(s(),n("img",{key:0,class:"article-image-inner",src:"https://files.gazprom.kg/"+i.findCover(a.images).path,alt:a.title},null,8,q)):(s(),n("img",T))]),l("div",null,[c(C,{to:`/consumers/news/${a.id}`,class:"news-title"},{default:g(()=>[h(m(a.title),1)]),_:2},1032,["to"]),l("div",V,m(i.formatDate(a.created)),1)])]))),128)),c(S,{"current-page":o.currentPage,"total-items":o.totalItems,"page-size":o.pageSize,onPageChanged:i.onPageChanged,onPageSizeChanged:i.onPageSizeChanged},null,8,["current-page","total-items","page-size","onPageChanged","onPageSizeChanged"])]))])])}const j=v(F,[["render",L],["__scopeId","data-v-8f7973c6"]]);export{j as default};
