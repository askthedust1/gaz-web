const __vite__fileDeps=["assets/ErrorModal-D8z2UzVK.js","assets/index-By43cUFe.js","assets/index-B55c09h6.css","assets/ErrorModal-COpPMQyn.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{_ as I}from"./StageList-BlXyFv42.js";import{o as n,c,b as s,U as x,m as L,u as G,k as N,l as M,n as O,_ as T,r as V,d as p,w as _,t as e,h as w,F as A,g as S,z as P,q as k,C as z,Y as R,f as F,p as j,e as U}from"./index-By43cUFe.js";import D from"./ErrorModal-D8z2UzVK.js";import{_ as Y}from"./animated-gradient-B4alTJSn.js";const q={xmlns:"http://www.w3.org/2000/svg",width:"12",height:"8",fill:"none"},H=s("path",{stroke:"#A5AEC4","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1.5 5 5 5-5"},null,-1),J=[H];function K(t,i){return n(),c("svg",q,[...J])}const Q={render:K},W={components:{BaseIsland:x,Arrow:Q,ErrorModal:D,StageList:I},data(){return{application:null,activeIndexes:[],loading:!1}},computed:{...L(G,["currentLang"])},methods:{...N(M,["open"]),async fetchApplication(){this.loading=!0;try{await this.$axiosApi.get(`applications/info/${this.$route.params.id}`).then(({data:t})=>{t&&(this.application=t)}).catch(t=>{console.log(t),this.open(D,{message:"Произошла ошибка при получении информации о заявке"})})}catch(t){console.log(t);const i=(await O(()=>import("./ErrorModal-D8z2UzVK.js"),__vite__mapDeps([0,1,2,3]))).default;this.open(i,{message:"Произошла ошибка при получении информации о заявке"})}this.loading=!1},calculateGroupStatus(t){return t.some(i=>i.status!=="Оплачен")?"Не оплачен":"Оплачен"},toggle(t){this.activeIndexes.includes(t)?this.activeIndexes=this.activeIndexes.filter(i=>i!==t):this.activeIndexes.push(t)},changeColor(t){if(t.status==="IN_PROGRESS")return"#FC9C3C";if(t.status==="DONE")return"#07D580";if(t.status==="TO_DO")return"#A5AEC4"},formatDate(t){const i=new Date(t),h=String(i.getDate()).padStart(2,"0"),v=String(i.getMonth()+1).padStart(2,"0"),a=i.getFullYear();return`${h}.${v}.${a}`}},beforeMount(){this.fetchApplication()}},l=t=>(j("data-v-82d34cc8"),t=t(),U(),t),X={key:0,class:"container"},Z={class:"application-main"},$={class:"application-info-wrapper"},ss={class:"application-info"},ts={class:"application-app"},as=l(()=>s("div",{class:"app-title"},"Заявка",-1)),os={class:"app-data"},es={class:"application-app"},is=l(()=>s("div",{class:"app-title"},"Адрес",-1)),ns={class:"app-data"},cs={class:"application-app"},us=l(()=>s("div",{class:"app-title"},"Лицевой счет",-1)),ls={class:"app-data"},ps={key:0,class:"application-details"},ds={class:"application-inner"},rs={class:"application-date"},_s=l(()=>s("div",{class:"app-title"},"Дата подачи заявки",-1)),hs={class:"app-data"},vs={class:"application-inner"},gs={class:"application-progress"},ms=l(()=>s("div",{class:"app-title"},"Статус",-1)),fs={class:"app-data"},Es={class:"application-payment"},ys={class:"application-payment-list"},Cs=l(()=>s("h3",{class:"application-payment-title"},"Счета к оплате",-1)),ws={key:0,class:"payment_history"},As=["onClick"],Ss={class:"accordion-title-wrapper"},ks={class:"icon-arrow"},Fs={class:"accordion-title"},Ds={class:"accordion-total"},Is={class:"accordion-body-wrapper"},xs={class:"accordion-name"},Bs={class:"application-code"},bs={key:1},Ls={key:0,class:"application-stages"},Gs=l(()=>s("h3",{class:"application-payment-title"},"Этапы",-1)),Ns={key:1,class:"preloader"},Ms=l(()=>s("div",{class:"loading"},[s("img",{src:Y,alt:"loading"})],-1)),Os=[Ms];function Ts(t,i,h,v,a,d){var g,m,f,E;const r=x,B=V("Arrow"),b=I;return a.loading?(n(),c("div",Ns,Os)):(n(),c("div",X,[s("div",Z,[s("div",$,[p(r,null,{"base-content":_(()=>{var o,u,y,C;return[s("div",ss,[s("div",ts,[as,s("span",os,e((o=a.application)==null?void 0:o.project.name),1)]),s("div",es,[is,s("span",ns,e((u=a.application)==null?void 0:u.address),1)]),s("div",cs,[us,s("span",ls,e((y=a.application)!=null&&y.account?(C=a.application)==null?void 0:C.account:"Лицевой счет в обработке"),1)])])]}),_:1})]),a.application?(n(),c("div",ps,[p(r,null,{"base-content":_(()=>[s("div",ds,[s("div",rs,[_s,s("span",hs,e(d.formatDate(a.application.created)),1)])])]),_:1}),p(r,null,{"base-content":_(()=>[s("div",vs,[s("div",gs,[ms,s("span",fs,e(a.application.status[t.currentLang]),1)])])]),_:1})])):w("",!0)]),s("div",Es,[s("div",ys,[Cs,a.application&&((g=a.application)==null?void 0:g.invoiceGroups.length)>0?(n(),c("div",ws,[(n(!0),c(A,null,S((m=a.application)==null?void 0:m.invoiceGroups,o=>(n(),c("div",{key:o.id,class:"accordion-item"},[s("div",{class:"accordion-header",onClick:u=>d.toggle(o.id)},[s("div",Ss,[s("div",ks,[p(B,{class:P({active:a.activeIndexes.includes(o.id)})},null,8,["class"])]),s("div",null,[s("div",Fs,e(o.name),1),s("div",Ds,"К оплате: "+e(o.totalAmount)+" сом",1)])]),s("div",{class:"accordion-status",style:k({width:"180px",backgroundColor:d.calculateGroupStatus(o.invoices)!=="Не оплачен"?"#1852E0":"#FC4E3C"})},e(d.calculateGroupStatus(o.invoices)),5)],8,As),z(s("div",Is,[(n(!0),c(A,null,S(o.invoices,u=>(n(),c("div",{class:"accordion-body",key:u.id},[s("div",xs,[s("b",Bs,"["+e(u.serviceType.code)+"]",1),F(" "+e(u.serviceType.name),1)]),s("div",null,[F("Сумма к оплате: "),s("b",null,e(u.amount)+" сом",1)]),s("div",{class:"application-status",style:k({backgroundColor:u.status==="Оплачен"?"#1852E0":"#FC4E3C"})},e(u.status),5)]))),128))],512),[[R,a.activeIndexes.includes(o.id)]])]))),128))])):(n(),c("div",bs,"Нет истории оплат"))])]),a.application&&((f=a.application)==null?void 0:f.stages.length)>0?(n(),c("div",Ls,[Gs,p(b,{stages:(E=a.application)==null?void 0:E.stages,currentLang:t.currentLang},null,8,["stages","currentLang"])])):w("",!0)]))}const js=T(W,[["render",Ts],["__scopeId","data-v-82d34cc8"]]);export{js as default};
