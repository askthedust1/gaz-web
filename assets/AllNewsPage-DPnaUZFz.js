import{m as x,u as v,_ as k,r as w,o as s,c as n,d as c,b as l,w as h,f as u,F as p,g as d,s as B,t as m,y as I}from"./index-B6tr8DrX.js";import{_}from"./PaginationComponent-4kMnWga4.js";import{C as f}from"./CategoriesBar-CImiXqo2.js";import{_ as D}from"./no-img-Dap1pkA8.js";const N={components:{CategoriesBar:f,PaginationComponent:_},data(){return{loading:!0,items:[],currentPage:1,pageSize:10,totalPages:1,totalItems:0}},computed:{...x(v,["currentLang"]),filterParams(){const t={};return this.currentPage&&(t.offset=(this.currentPage-1)*this.pageSize),this.pageSize&&(t.limit=this.pageSize),t.sort="created",t.lang=this.currentLang,t}},watch:{filterParams(){this.fetchItems(),this.fetchCount()}},methods:{init(){this.loading=!0;const t=Number(this.$route.query.page)||1;this.currentPage=t;const e=[];e.push(this.fetchItems(),this.fetchCount()),Promise.all(e).finally(()=>{this.loading=!1})},fetchCount(){return this.$axiosApi.get("gazprom-app/content/news/count",{params:this.filterParams}).then(t=>{const{total:e,pages:r}=t.data;this.totalItems=e,this.totalPages=r}).catch(t=>{console.log(t)}).finally(()=>{this.loading=!1})},fetchItems(){return this.loading=!0,this.$axiosApi.get("gazprom-app/content/news",{params:this.filterParams}).then(t=>{this.items=t.data}).catch(t=>{console.log(t)}).finally(()=>{this.loading=!1})},findCover(t){if(!t)return;const e=t.find(r=>r.tag==="COVER");return e||null},formatDate(t){const e=new Date(t),r=String(e.getDate()).padStart(2,"0"),g=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();return`${r}.${g}.${o}`},onPageChanged(t){this.currentPage=t,this.$router.push({path:this.$route.path,query:{...this.$route.query,page:String(t)}})},onPageSizeChanged(t){this.pageSize=t,this.currentPage=1}},created(){this.init()}},$={class:"container"},b={style:{width:"100%"}},q={key:0,class:"all-news"},A={class:"article-image"},E=["src","alt"],F={key:1,class:"article-image-inner",src:D},V={class:"news-date"},L={key:1,style:{display:"flex","flex-direction":"column",gap:"20px"}};function T(t,e,r,g,o,i){const P=f,y=B,C=w("router-link"),S=_,z=I;return s(),n("div",$,[c(P),l("div",b,[c(y,{tag:"h2",size:"small",style:{margin:"33px 0 30px 0"}},{default:h(()=>[u("Новости")]),_:1}),o.loading?(s(),n("div",L,[(s(),n(p,null,d(6,a=>c(z,{key:a,style:{height:"200px",width:"100%","border-radius":"32px","margin-bottom":"30px"}})),64))])):(s(),n("div",q,[(s(!0),n(p,null,d(o.items,a=>(s(),n("div",{key:a.id,class:"article"},[l("div",A,[i.findCover(a.images)?(s(),n("img",{key:0,class:"article-image-inner",src:"https://files.gazprom.kg/"+i.findCover(a.images).path,alt:a.title},null,8,E)):(s(),n("img",F))]),l("div",null,[c(C,{to:`/consumers/news/${a.id}`,class:"news-title"},{default:h(()=>[u(m(a.title),1)]),_:2},1032,["to"]),l("div",V,m(i.formatDate(a.created)),1)])]))),128)),c(S,{"current-page":o.currentPage,"total-items":o.totalItems,"page-size":o.pageSize,onPageChanged:i.onPageChanged,onPageSizeChanged:i.onPageSizeChanged},null,8,["current-page","total-items","page-size","onPageChanged","onPageSizeChanged"])]))])])}const j=k(N,[["render",T],["__scopeId","data-v-cf875207"]]);export{j as default};
